{"remainingRequest":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/babel-loader/lib/index.js!/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/src/libs/dynamicDBClient.ts","dependencies":[{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/src/libs/dynamicDBClient.ts","mtime":1594439286214},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/.babelrc","mtime":1594434757670},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgRHluYW1vREIgfSBmcm9tICdhd3Mtc2RrJzsKCi8qKgogKiBBV1MgRHluYW1vREIgQ2xpZW50CiAqCiAqIEBleHBvcnQKICogQGNsYXNzIER5bmFtb0RCQ2xpZW50CiAqLwpleHBvcnQgY2xhc3MgRHluYW1vREJDbGllbnQgewogIGNvbnN0cnVjdG9yKCkgewogICAgdGhpcy5jbGllbnQgPSBuZXcgRHluYW1vREIuRG9jdW1lbnRDbGllbnQoKTsKICB9CiAgLyoqCiAgICogQ3JlYXRlIGEgcmVjb3JkCiAgICoKICAgKiBAcGFyYW0ge0R5bmFtb0RCLkRvY3VtZW50Q2xpZW50LlB1dEl0ZW1JbnB1dH0gcGFyYW1zCiAgICogQHJldHVybnMKICAgKiBAbWVtYmVyb2YgRHluYW1vREJDbGllbnQKICAgKi8KCgogIGNyZWF0ZShwYXJhbXMpIHsKICAgIHJldHVybiB0aGlzLmNsaWVudC5wdXQocGFyYW1zKS5wcm9taXNlKCk7CiAgfQogIC8qKgogICAqIEdldCBhIHJlY29yZAogICAqCiAgICogQHBhcmFtIHtEeW5hbW9EQi5Eb2N1bWVudENsaWVudC5HZXRJdGVtSW5wdXR9IHBhcmFtcwogICAqIEByZXR1cm5zCiAgICogQG1lbWJlcm9mIER5bmFtb0RCQ2xpZW50CiAgICovCgoKICBnZXQocGFyYW1zKSB7CiAgICByZXR1cm4gdGhpcy5jbGllbnQuZ2V0KHBhcmFtcykucHJvbWlzZSgpOwogIH0KICAvKioKICAgKiBRdWVyeSBhbiBpbmRleAogICAqCiAgICogQHBhcmFtIHtEeW5hbW9EQi5Eb2N1bWVudENsaWVudC5RdWVyeUlucHV0fSBwYXJhbXMKICAgKiBAcmV0dXJucwogICAqIEBtZW1iZXJvZiBEeW5hbW9EQkNsaWVudAogICAqLwoKCiAgcXVlcnkocGFyYW1zKSB7CiAgICByZXR1cm4gdGhpcy5jbGllbnQucXVlcnkocGFyYW1zKS5wcm9taXNlKCk7CiAgfQogIC8qKgogICAqIFVwZGF0ZSBhIHJlY29yZAogICAqCiAgICogQHBhcmFtIHtEeW5hbW9EQi5Eb2N1bWVudENsaWVudC5VcGRhdGVJdGVtSW5wdXR9IHBhcmFtcwogICAqIEByZXR1cm5zCiAgICogQG1lbWJlcm9mIER5bmFtb0RCQ2xpZW50CiAgICovCgoKICB1cGRhdGUocGFyYW1zKSB7CiAgICByZXR1cm4gdGhpcy5jbGllbnQudXBkYXRlKHBhcmFtcykucHJvbWlzZSgpOwogIH0KICAvKioKICAgKiBTY2FuIHRhYmxlCiAgICoKICAgKiBAcGFyYW0ge0R5bmFtb0RCLkRvY3VtZW50Q2xpZW50LlRhYmxlTmFtZX0gdGFibGVOYW1lCiAgICogQHJldHVybnMKICAgKiBAbWVtYmVyb2YgRHluYW1vREJDbGllbnQKICAgKi8KCgogIGFzeW5jIHNjYW4odGFibGVOYW1lKSB7CiAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgIFRhYmxlTmFtZTogdGFibGVOYW1lCiAgICB9OwogICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuY2xpZW50LnNjYW4ocGFyYW1zKS5wcm9taXNlKCk7CiAgICByZXR1cm4gZGF0YS5JdGVtczsKICB9CiAgLyoqCiAgICogRGVsZXRlIGEgcmVjb3JkCiAgICoKICAgKiBAcGFyYW0ge0R5bmFtb0RCLkRvY3VtZW50Q2xpZW50LlRhYmxlTmFtZX0gdGFibGVOYW1lCiAgICogQHBhcmFtIHtEeW5hbW9EQi5Eb2N1bWVudENsaWVudC5BdHRyaWJ1dGVNYXB9IGl0ZW0KICAgKiBAcmV0dXJucwogICAqIEBtZW1iZXJvZiBEeW5hbW9EQkNsaWVudAogICAqLwoKCiAgZGVsZXRlKHRhYmxlTmFtZSwgaXRlbSkgewogICAgY29uc3QgcGFyYW1zID0gewogICAgICBUYWJsZU5hbWU6IHRhYmxlTmFtZSwKICAgICAgS2V5OiB7CiAgICAgICAgaWQ6IGl0ZW0uaWQKICAgICAgfQogICAgfTsKICAgIHJldHVybiB0aGlzLmNsaWVudC5kZWxldGUocGFyYW1zKS5wcm9taXNlKCk7CiAgfQogIC8qKgogICAqIEVtcHR5IGEgdGFibGUKICAgKgogICAqIEBwYXJhbSB7RHluYW1vREIuRG9jdW1lbnRDbGllbnQuVGFibGVOYW1lfSB0YWJsZU5hbWUKICAgKiBAcmV0dXJucwogICAqIEBtZW1iZXJvZiBEeW5hbW9EQkNsaWVudAogICAqLwoKCiAgYXN5bmMgY2xlYXIodGFibGVOYW1lKSB7CiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHRoaXMuc2Nhbih0YWJsZU5hbWUpOwogICAgY29uc3QgcHJvbWlzZXMgPSBpdGVtcz8ubWFwKGl0ZW0gPT4gdGhpcy5kZWxldGUodGFibGVOYW1lLCBpdGVtKSk7CiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpOwogIH0KCn0="},{"version":3,"sources":["/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/src/libs/dynamicDBClient.ts"],"names":["DynamoDB","DynamoDBClient","constructor","client","DocumentClient","create","params","put","promise","get","query","update","scan","tableName","TableName","data","Items","delete","item","Key","id","clear","items","promises","map","Promise","all"],"mappings":"AAAA,SAASA,QAAT,QAAyB,SAAzB;;AAEA;;;;;;AAMA,OAAO,MAAMC,cAAN,CAAqB;AAE1BC,EAAAA,WAAW,GAAG;AACZ,SAAKC,MAAL,GAAc,IAAIH,QAAQ,CAACI,cAAb,EAAd;AACD;AACD;;;;;;;;;AAOAC,EAAAA,MAAM,CAACC,MAAD,EAA+C;AACnD,WAAO,KAAKH,MAAL,CAAYI,GAAZ,CAAgBD,MAAhB,EAAwBE,OAAxB,EAAP;AACD;AACD;;;;;;;;;AAOAC,EAAAA,GAAG,CAACH,MAAD,EAA+C;AAChD,WAAO,KAAKH,MAAL,CAAYM,GAAZ,CAAgBH,MAAhB,EAAwBE,OAAxB,EAAP;AACD;AACD;;;;;;;;;AAOAE,EAAAA,KAAK,CAACJ,MAAD,EAA6C;AAChD,WAAO,KAAKH,MAAL,CAAYO,KAAZ,CAAkBJ,MAAlB,EAA0BE,OAA1B,EAAP;AACD;AACD;;;;;;;;;AAOAG,EAAAA,MAAM,CAACL,MAAD,EAAkD;AACtD,WAAO,KAAKH,MAAL,CAAYQ,MAAZ,CAAmBL,MAAnB,EAA2BE,OAA3B,EAAP;AACD;AACD;;;;;;;;;AAOA,QAAMI,IAAN,CAAWC,SAAX,EAAyD;AACvD,UAAMP,MAAyC,GAAG;AAChDQ,MAAAA,SAAS,EAAED;AADqC,KAAlD;AAIA,UAAME,IAAI,GAAG,MAAM,KAAKZ,MAAL,CAAYS,IAAZ,CAAiBN,MAAjB,EAAyBE,OAAzB,EAAnB;AACA,WAAOO,IAAI,CAACC,KAAZ;AACD;AACD;;;;;;;;;;AAQAC,EAAAA,MAAM,CAACJ,SAAD,EAA+CK,IAA/C,EAA2F;AAC/F,UAAMZ,MAA+C,GAAG;AACtDQ,MAAAA,SAAS,EAAED,SAD2C;AAEtDM,MAAAA,GAAG,EAAE;AACHC,QAAAA,EAAE,EAAEF,IAAI,CAACE;AADN;AAFiD,KAAxD;AAMA,WAAO,KAAKjB,MAAL,CAAYc,MAAZ,CAAmBX,MAAnB,EAA2BE,OAA3B,EAAP;AACD;AACD;;;;;;;;;AAOA,QAAMa,KAAN,CAAYR,SAAZ,EAA0D;AACxD,UAAMS,KAAK,GAAG,MAAM,KAAKV,IAAL,CAAUC,SAAV,CAApB;AACA,UAAMU,QAAa,GAAGD,KAAK,EAAEE,GAAP,CAAWN,IAAI,IAAI,KAAKD,MAAL,CAAYJ,SAAZ,EAAuBK,IAAvB,CAAnB,CAAtB;AACA,WAAOO,OAAO,CAACC,GAAR,CAAYH,QAAZ,CAAP;AACD;;AAxFyB","sourcesContent":["import { DynamoDB } from 'aws-sdk';\nimport { DocumentClient } from 'aws-sdk/clients/dynamodb';\n/**\n * AWS DynamoDB Client\n *\n * @export\n * @class DynamoDBClient\n */\nexport class DynamoDBClient {\n  private client: DocumentClient;\n  constructor() {\n    this.client = new DynamoDB.DocumentClient();\n  }\n  /**\n   * Create a record\n   *\n   * @param {DynamoDB.DocumentClient.PutItemInput} params\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  create(params: DynamoDB.DocumentClient.PutItemInput) {\n    return this.client.put(params).promise();\n  }\n  /**\n   * Get a record\n   *\n   * @param {DynamoDB.DocumentClient.GetItemInput} params\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  get(params: DynamoDB.DocumentClient.GetItemInput) {\n    return this.client.get(params).promise();\n  }\n  /**\n   * Query an index\n   *\n   * @param {DynamoDB.DocumentClient.QueryInput} params\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  query(params: DynamoDB.DocumentClient.QueryInput) {\n    return this.client.query(params).promise();\n  }\n  /**\n   * Update a record\n   *\n   * @param {DynamoDB.DocumentClient.UpdateItemInput} params\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  update(params: DynamoDB.DocumentClient.UpdateItemInput) {\n    return this.client.update(params).promise();\n  }\n  /**\n   * Scan table\n   *\n   * @param {DynamoDB.DocumentClient.TableName} tableName\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  async scan(tableName: DynamoDB.DocumentClient.TableName) {\n    const params: DynamoDB.DocumentClient.ScanInput = {\n      TableName: tableName,\n    };\n\n    const data = await this.client.scan(params).promise();\n    return data.Items;\n  }\n  /**\n   * Delete a record\n   *\n   * @param {DynamoDB.DocumentClient.TableName} tableName\n   * @param {DynamoDB.DocumentClient.AttributeMap} item\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  delete(tableName: DynamoDB.DocumentClient.TableName, item: DynamoDB.DocumentClient.AttributeMap) {\n    const params: DynamoDB.DocumentClient.DeleteItemInput = {\n      TableName: tableName,\n      Key: {\n        id: item.id,\n      },\n    };\n    return this.client.delete(params).promise();\n  }\n  /**\n   * Empty a table\n   *\n   * @param {DynamoDB.DocumentClient.TableName} tableName\n   * @returns\n   * @memberof DynamoDBClient\n   */\n  async clear(tableName: DynamoDB.DocumentClient.TableName) {\n    const items = await this.scan(tableName);\n    const promises: any = items?.map(item => this.delete(tableName, item));\n    return Promise.all(promises);\n  }\n}\n"]}]}