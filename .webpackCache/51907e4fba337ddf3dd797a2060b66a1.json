{"remainingRequest":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/babel-loader/lib/index.js!/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/src/models/sku.ts","dependencies":[{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/src/models/sku.ts","mtime":1594439341140},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/.babelrc","mtime":1594434757670},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8gY29uc3QgeyB1dWlkIH0gPSByZXF1aXJlKCd1dWlkdjQnKTsKLy8gY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnLi4vbGlicy9sb2dnZXInKTsKZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2t1IHsKICBjb25zdHJ1Y3Rvcih0YWJsZU5hbWUsIHN0b3JlKSB7CiAgICB0aGlzLnRhYmxlTmFtZSA9IHRhYmxlTmFtZTsKICAgIHRoaXMuc3RvcmUgPSBzdG9yZTsKICB9CgogIGFzeW5jIGNyZWF0ZShza3UpIHsKICAgIC8vIGxvZ2dlci5pbmZvKGBTa3UgJHtTa3Uuc2t1fWApOwogICAgY29uc3QgaXRlbSA9IHsKICAgICAgc2t1OiBza3Uuc2t1LAogICAgICBuYW1lOiBza3UubmFtZSwKICAgICAgcHJpY2U6IHNrdS5wcmljZSwKICAgICAgaW1nOiBza3UuaW1nLAogICAgICBjcmVhdGVkQXQ6IERhdGUubm93KCkKICAgIH07CiAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgIFRhYmxlTmFtZTogdGhpcy50YWJsZU5hbWUsCiAgICAgIEl0ZW06IGl0ZW0KICAgIH07CiAgICByZXR1cm4gdGhpcy5zdG9yZS5jcmVhdGUocGFyYW1zKTsKICB9CgogIGFzeW5jIGZpbmRSZWNvcmRCeVNrdShza3UpIHsKICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgVGFibGVOYW1lOiB0aGlzLnRhYmxlTmFtZSwKICAgICAgLy8gICBJbmRleE5hbWU6ICdTa3UtaW5kZXgnLAogICAgICBLZXlDb25kaXRpb25FeHByZXNzaW9uOiAnI3QgPSA6dCcsCiAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lczogewogICAgICAgICcjdCc6ICdza3UnCiAgICAgIH0sCiAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IHsKICAgICAgICAnOnQnOiBza3UKICAgICAgfQogICAgfTsKICAgIGNvbnN0IHJlY29yZCA9IGF3YWl0IHRoaXMuc3RvcmUucXVlcnkocGFyYW1zKS50aGVuKHJlc3VsdCA9PiByZXN1bHQuSXRlbXNbMF0pOwogICAgcmV0dXJuIHJlY29yZDsKICB9CgogIGFzeW5jIHVwZGF0ZVByaWNlKHNrdSwgcHJpY2UpIHsKICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgVGFibGVOYW1lOiB0aGlzLnRhYmxlTmFtZSwKICAgICAgS2V5OiB7CiAgICAgICAgc2t1CiAgICAgIH0sCiAgICAgIFVwZGF0ZUV4cHJlc3Npb246ICdTRVQgI3ByaWNlID0gOnByaWNlJywKICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzOiB7CiAgICAgICAgJyNwcmljZSc6ICdwcmljZScKICAgICAgfSwKICAgICAgRXhwcmVzc2lvbkF0dHJpYnV0ZVZhbHVlczogewogICAgICAgICc6cHJpY2UnOiBwcmljZQogICAgICB9LAogICAgICBSZXR1cm5WYWx1ZXM6ICdBTExfTkVXJwogICAgfTsKICAgIGF3YWl0IHRoaXMuc3RvcmUudXBkYXRlKHBhcmFtcyk7CiAgfSAvLyAgIGFzeW5jIGZpbmRSZWNvcmRzQnlBY2NvdW50SWQoYWNjb3VudElkKSB7CiAgLy8gICAgIGxvZ2dlci5pbmZvKGBhY2NvdW50SWQgJHthY2NvdW50SWR9YCk7CiAgLy8gICAgIGNvbnN0IHBhcmFtcyA9IHsKICAvLyAgICAgICBUYWJsZU5hbWU6IHRoaXMudGFibGVOYW1lLAogIC8vICAgICAgIEluZGV4TmFtZTogJ2FjY291bnRJZC1pbmRleCcsCiAgLy8gICAgICAgS2V5Q29uZGl0aW9uRXhwcmVzc2lvbjogJyN0ID0gOnQnLAogIC8vICAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVOYW1lczogewogIC8vICAgICAgICAgJyN0JzogJ2FjY291bnRJZCcsCiAgLy8gICAgICAgfSwKICAvLyAgICAgICBFeHByZXNzaW9uQXR0cmlidXRlVmFsdWVzOiB7CiAgLy8gICAgICAgICAnOnQnOiBhY2NvdW50SWQsCiAgLy8gICAgICAgfSwKICAvLyAgICAgfTsKICAvLyAgICAgY29uc3QgcmVjb3JkcyA9IGF3YWl0IHRoaXMuc3RvcmUucXVlcnkocGFyYW1zKS50aGVuKChyZXN1bHQpID0+IHJlc3VsdC5JdGVtcyk7CiAgLy8gICAgIHJldHVybiByZWNvcmRzOwogIC8vICAgfQoKCn0="},{"version":3,"sources":["/Users/rahulgolash/Rahul/Professional/Assignments/ecommerce-serverless/src/models/sku.ts"],"names":["Sku","constructor","tableName","store","create","sku","item","name","price","img","createdAt","Date","now","params","TableName","Item","findRecordBySku","KeyConditionExpression","ExpressionAttributeNames","ExpressionAttributeValues","record","query","then","result","Items","updatePrice","Key","UpdateExpression","ReturnValues","update"],"mappings":"AAAA;AACA;AAIA,eAAe,MAAMA,GAAN,CAAU;AAIvBC,EAAAA,WAAW,CAACC,SAAD,EAA+CC,KAA/C,EAAsE;AAC/E,SAAKD,SAAL,GAAiBA,SAAjB;AACA,SAAKC,KAAL,GAAaA,KAAb;AACD;;AAED,QAAMC,MAAN,CAAaC,GAAb,EAAwB;AACtB;AACA,UAAMC,IAAI,GAAG;AACXD,MAAAA,GAAG,EAAEA,GAAG,CAACA,GADE;AAEXE,MAAAA,IAAI,EAAEF,GAAG,CAACE,IAFC;AAGXC,MAAAA,KAAK,EAAEH,GAAG,CAACG,KAHA;AAIXC,MAAAA,GAAG,EAAEJ,GAAG,CAACI,GAJE;AAKXC,MAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL;AALA,KAAb;AAOA,UAAMC,MAAM,GAAG;AACbC,MAAAA,SAAS,EAAE,KAAKZ,SADH;AAEba,MAAAA,IAAI,EAAET;AAFO,KAAf;AAIA,WAAO,KAAKH,KAAL,CAAWC,MAAX,CAAkBS,MAAlB,CAAP;AACD;;AAED,QAAMG,eAAN,CAAsBX,GAAtB,EAAmC;AACjC,UAAMQ,MAAM,GAAG;AACbC,MAAAA,SAAS,EAAE,KAAKZ,SADH;AAEb;AACAe,MAAAA,sBAAsB,EAAE,SAHX;AAIbC,MAAAA,wBAAwB,EAAE;AACxB,cAAM;AADkB,OAJb;AAObC,MAAAA,yBAAyB,EAAE;AACzB,cAAMd;AADmB;AAPd,KAAf;AAYA,UAAMe,MAAM,GAAG,MAAM,KAAKjB,KAAL,CAAWkB,KAAX,CAAiBR,MAAjB,EAAyBS,IAAzB,CAA+BC,MAAD,IAAiBA,MAAM,CAACC,KAAP,CAAa,CAAb,CAA/C,CAArB;AACA,WAAOJ,MAAP;AACD;;AAED,QAAMK,WAAN,CAAkBpB,GAAlB,EAA+BG,KAA/B,EAA8C;AAC5C,UAAMK,MAAM,GAAG;AACbC,MAAAA,SAAS,EAAE,KAAKZ,SADH;AAEbwB,MAAAA,GAAG,EAAE;AAAErB,QAAAA;AAAF,OAFQ;AAGbsB,MAAAA,gBAAgB,EAAE,qBAHL;AAIbT,MAAAA,wBAAwB,EAAE;AACxB,kBAAU;AADc,OAJb;AAObC,MAAAA,yBAAyB,EAAE;AACzB,kBAAUX;AADe,OAPd;AAUboB,MAAAA,YAAY,EAAE;AAVD,KAAf;AAYA,UAAM,KAAKzB,KAAL,CAAW0B,MAAX,CAAkBhB,MAAlB,CAAN;AACD,GAxDsB,CA0DvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;AA1EuB","sourcesContent":["// const { uuid } = require('uuidv4');\n// const logger = require('../libs/logger');\nimport { DynamoDB } from 'aws-sdk';\nimport { DynamoDBClient } from '../libs/dynamicDBClient';\n\nexport default class Sku {\n  private store: DynamoDBClient;\n  private tableName: DynamoDB.DocumentClient.TableName;\n\n  constructor(tableName: DynamoDB.DocumentClient.TableName, store: DynamoDBClient) {\n    this.tableName = tableName;\n    this.store = store;\n  }\n\n  async create(sku: tSku) {\n    // logger.info(`Sku ${Sku.sku}`);\n    const item = {\n      sku: sku.sku,\n      name: sku.name,\n      price: sku.price,\n      img: sku.img,\n      createdAt: Date.now(),\n    };\n    const params = {\n      TableName: this.tableName,\n      Item: item,\n    };\n    return this.store.create(params);\n  }\n\n  async findRecordBySku(sku: string) {\n    const params = {\n      TableName: this.tableName,\n      //   IndexName: 'Sku-index',\n      KeyConditionExpression: '#t = :t',\n      ExpressionAttributeNames: {\n        '#t': 'sku',\n      },\n      ExpressionAttributeValues: {\n        ':t': sku,\n      },\n    };\n\n    const record = await this.store.query(params).then((result: any) => result.Items[0]);\n    return record;\n  }\n\n  async updatePrice(sku: string, price: number) {\n    const params = {\n      TableName: this.tableName,\n      Key: { sku },\n      UpdateExpression: 'SET #price = :price',\n      ExpressionAttributeNames: {\n        '#price': 'price',\n      },\n      ExpressionAttributeValues: {\n        ':price': price,\n      },\n      ReturnValues: 'ALL_NEW',\n    };\n    await this.store.update(params);\n  }\n\n  //   async findRecordsByAccountId(accountId) {\n  //     logger.info(`accountId ${accountId}`);\n  //     const params = {\n  //       TableName: this.tableName,\n  //       IndexName: 'accountId-index',\n  //       KeyConditionExpression: '#t = :t',\n  //       ExpressionAttributeNames: {\n  //         '#t': 'accountId',\n  //       },\n  //       ExpressionAttributeValues: {\n  //         ':t': accountId,\n  //       },\n  //     };\n\n  //     const records = await this.store.query(params).then((result) => result.Items);\n  //     return records;\n  //   }\n}\n"]}]}